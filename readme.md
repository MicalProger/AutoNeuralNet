# Универсальная нейронная сеть с учителем AutoNeuralNet #
## О нейронной сети ANN ##
Нейронная сеть ANN является обучаемой нейронной сетью типа перцептрон с реализованными алгоритмами forward propagation и back propagation. Т.к ANN является универсальной, то количество входов и выходов, конфигурация и количество солев, входные и выходные значения могут быть произвольными и задаются програмно.
## Использование ##
1. Инициализация
2. Обучение
3. Применение
## 1. Инициализация ##
Класс, отвечающий за вычисления называется NeuralCore
Создать экземпляр класса можно двумя способами:
1. При помощи конфигурации слоев
```c#
NeuralCore net = new NeuralCore(new int[] {10, 5, 3, 1});
```
Конфигурация слоев указывается как массив int, где под индексом 0 - кол-во нейронов, а последний элемент - это кол-во выходов.
2. При указании путя к файлу со значениями весов в формате JSON.
```c#
NeuralCore net = new NeuralCore("fath/to/links/values");
```
Значения весов нейронной и конфигурация определяется автоматичски и нейросеть готова к работе.
## 2. Обучение с учителем ##
Обучение - это самая важная часть данной системы. При помощи неё можно автоматически настроить значения весов нейросети. Обучение реализуется методом StartTraining
```c#
net.StartTraining(100000, inputs, outs, 0.001);
```
Метод StartTraining имеет исгнатуру void StartTraining(int iterations, double[][] tests, double[][] correctOutputs, double lmd = 0.001).
1. Параметр iterations отвечает за поличество итераций обучения нейронной сети. 
2. Параметры tests и correctOutputs - входные данные и правильные выходные к сообветствующим входным. Эти параматры является массивами из массивов входных и выхондых данных. 
3. Параметр lmd отвечвет скорость обучения как множетель в корректеровке весов нейросети.
Метод  StartTraining не единственный изменить значения весов кроме как при инициализации. Для этого следует использовать метод void SetAllMatrixes(double[][,] m)
```c#
double[][,] layers = new double[3][,];
layers[0] = new double[10, 5];
layers[1] = new double[5, 3];
layers[2] = new double[3, 1];
net.SetAllMatrixes(layers);
```
если нужно поменять значения всех весов и void SetMatrix(double[,] m, int layer)
```c#
double[,] layer = new double[10,5];
net.SetMatrix(layer, 0);
```
для извенения весов конкретного слоя. 
Для того, чтобы сохранить прогресс обучения используйте метод void SaveLinks(string savingPath). В качестве параметра укажите путь для сохранения весов.
## 3. Генетическое обучение ##
Также внедрятся генетический алогитм обучения без учителя. Для использования этого метода обучения предназначен класс GenericLearner. В нем для обучения необходимо изначально назначить стартовую нейросеть. Для генерации популяции предназначен метод void GeneratePopulation(). Он Обновляет словарь с популяциями - Dictionary<int, (double score, NeuralCore net)> Population. В нем вы должны выставлять счет для каждой конкретной "особи" по индексу. После завершения выставления очков для нудных "особей" нужно обновить лучшую "особь" методом void ResetBest(). Лучшая нейросеть содержится в поле NeuralCore BestNet.
## 4. Применение ##
Прикладное использование AutoNeuralNet осуществляется всего одним способом - при помощи метода double[] RunNet(double[] values),  параметры которого нужно указать значения для анализаю Функция вернет массив из выхондых значений нейронной сети.
```c#
var ans = net.RunNet(new double[] {0.5, 0.1, 0.9, 0.7});
```